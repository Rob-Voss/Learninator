<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gravity With A Vector With Bounce And Elasticity</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap-theme.min.css"
          rel="stylesheet" type="text/css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet"
          type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet"
          type="text/css">
    <link href="css/styles.css" rel="stylesheet" type="text/css">

    <script src="js/lib/external/modernizr.js"></script>

    <script type="text/javascript">

        function start() {
            var rendererOpts = {
                    antialiasing: false,
                    autoResize: false,
                    resolution: window.devicePixelRatio,
                    resizable: false,
                    transparent: false,
                    noWebGL: true,
                    width: 600,
                    height: 600
                },
                renderer = PIXI.autoDetectRenderer(rendererOpts.width, rendererOpts.height, rendererOpts),
                stage = new PIXI.Container(),
                speed = 6,
                gravity = .1,
                elasticity = .5,
                angle = 285,
                radians = angle * Math.PI / 180,
                radius = 15,
                vx = Math.cos(radians) * speed,
                vy = Math.sin(radians) * speed,
                p1 = {
                    x: 20,
                    y: rendererOpts.width - radius
                },
                ball = new PIXI.Graphics();
            ball.position = new Vec(p1.x, p1.y, vx, vy);
            ball.radius = radius;
            ball.elasticity = elasticity;

            renderer.backgroundColor = 0xFFFFFF;

            // Put the renderer on screen in the corner
            renderer.view.style.position = "absolute";
            renderer.view.style.top = "0px";
            renderer.view.style.left = "0px";

            // Actually place the renderer onto the page for display
            document.body.querySelector('.game-container').appendChild(renderer.view);

            stage.addChild(ball);

            function resize() {
                // Determine which screen dimension is most constrained
                let ratio = Math.min(window.innerWidth / rendererOpts.width, window.innerHeight / rendererOpts.height);
                // Scale the view appropriately to fill that dimension
                stage.scale.x = stage.scale.y = ratio;
                // Update the renderer dimensions
                renderer.resize(Math.ceil(rendererOpts.width * ratio), Math.ceil(rendererOpts.height * ratio));
            }

            if (this.resizable) {
                // Listen for and adapt to changes to the screen size, e.g.,
                // user changing the window or rotating their device
                window.addEventListener("resize", resize);

                // Size the renderer to fill the screen
                resize();
            }

            function animate() {
                ball.clear();
                ball.lineStyle(1, 0x000000);
                ball.beginFill(0x000000);
                ball.drawCircle(ball.position.x, ball.position.y, ball.radius);
                ball.endFill();

                ball.position.vy += gravity;
                if ((ball.position.y + ball.radius) > rendererOpts.height) {
                    ball.position.vy = -(ball.position.vy) * ball.elasticity;
                }
                ball.position.advance();
                renderer.render(stage);
                requestAnimationFrame(animate);
            }

            requestAnimationFrame(animate);
        }

        window.addEventListener('load', eventWindowLoaded, false);
        function eventWindowLoaded() {
            start();
//            canvasApp();
        }

        function canvasSupport() {
            return Modernizr.canvas;
        }

        function canvasApp() {
            if (!canvasSupport()) {
                return;
            }
            var theCanvas = document.getElementById('canvasOne');
            var context = theCanvas.getContext('2d');

            function drawScreen() {
                context.fillStyle = '#EEEEEE';
                context.fillRect(0, 0, theCanvas.width, theCanvas.height);
                //Box
                context.strokeStyle = '#000000';
                context.strokeRect(1, 1, theCanvas.width - 2, theCanvas.height - 2);

                ball.position.vy += gravity;
                if ((ball.position.y + ball.radius) > theCanvas.height) {
                    ball.position.vy = -(ball.position.vy) * ball.elasticity;
                }
                ball.position.advance();

                context.fillStyle = "#000000";
                context.beginPath();
                context.arc(ball.position.x, ball.position.y, ball.radius, 0, Math.PI * 2, true);
                context.closePath();
                context.fill();
            }

            var speed = 6,
                gravity = .1,
                elasticity = .5,
                angle = 285,
                radians = angle * Math.PI / 180,
                radius = 15,
                vx = Math.cos(radians) * speed,
                vy = Math.sin(radians) * speed,
                p1 = {
                    x: 20,
                    y: theCanvas.width - radius
                },
                ball = {
                    pos: new Vec(p1.x, p1.y, vx, vy),
                    radius: radius,
                    elasticity: elasticity
                };

            setInterval(drawScreen, 33);
        }
    </script>

</head>
<body>
<div id="container" style="position: absolute; top: 50px; left: 50px;">
    <div class="game-container"></div>
    <canvas id="canvasOne" width="500" height="500">
        Your browser does not support the HTML 5 Canvas.
    </canvas>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/3.0.8/pixi.js"></script>
<script src="js/lib/Point.js"></script>
<script src="js/lib/Utility.js"></script>
<script src="js/lib/Vec.js"></script>
</body>
</html>



