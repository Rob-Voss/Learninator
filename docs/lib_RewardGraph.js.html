<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/RewardGraph.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/RewardGraph.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var RewardGraph = RewardGraph || {};

(function (global) {
    "use strict";

    /**
     * RewardGraph
     * @param {Object} opts
     * @returns {RewardGraph}
     * @name RewardGraph
     * @constructor
     */
    var RewardGraph = function (opts) {
        this.canvas = Utility.getOpt(opts, 'canvas', document.getElementById("rewardGraph"));
        this.ctx = this.canvas.getContext("2d");

        this.stepHorizon = Utility.getOpt(opts, 'stepHorizon', 1000);
        this.width = Utility.getOpt(opts, 'width', this.canvas.width);
        this.height = Utility.getOpt(opts, 'height', this.canvas.height);

        if (typeof opts.maxy !== 'undefined') {
            this.maxyForced = opts.maxy;
        }
        if (typeof opts.miny !== 'undefined') {
            this.minyForced = opts.miny;
        }

        this.maxy = -9999;
        this.miny = 9999;

        this.styles = ['black', 'red', 'green', 'blue', 'navy', 'magenta', 'cyan', 'purple', 'aqua', 'olive', 'lime'];
        this.hexStyles = [0x000000, 0xFF0000, 0x00FF00, 0x0000FF, 0x000080, 0xFF00FF, 0x00FFFF, 0x800080, 0x00FFFF, 0x808000, 0x00FF00];

        this.pts = [];

        return this;
    };

    /**
     * Set the legend and colors up
     * @param legend
     */
    RewardGraph.prototype.setLegend = function (legend) {
        this.legend = legend;
        this.numLines = this.legend.length;
        this.pts = new Array(this.numLines);
        for (let i = 0; i &lt; this.numLines; i++) {
            this.pts[i] = [];
        }
    };

    /**
     * Add a point to the graph
     * @param {Number} step
     * @param {Number} yl
     * @returns {undefined}
     */
    RewardGraph.prototype.addPoint = function (step, idx, yl) {
        // in ms
        var time = new Date().getTime(),
            n = yl.length,
            point = {
                step: step,
                time: time,
                yl: yl
            };

        for (let k = 0; k &lt; n; k++) {
            let y = yl[k];
            if (y > this.maxy * 0.99) {
                this.maxy = y * 1.05;
            }
            if (y &lt; this.miny * 1.01) {
                this.miny = y * 0.95;
            }
        }

        if (typeof this.maxyForced !== 'undefined') {
            this.maxy = this.maxyForced;
        }
        if (typeof this.minyForced !== 'undefined') {
            this.miny = this.minyForced;
        }

        if (this.pts[idx] !== undefined) {
            this.pts[idx].push(point);
        } else {
            this.pts[idx] = [];
        }

        if (step > this.stepHorizon) {
            this.stepHorizon *= 2;
        }
    };

    /**
     * Draw it
     * @returns {undefined}
     */
    RewardGraph.prototype.drawPoints = function () {
        var pad = 25,
            H = this.height,
            W = this.width,
            ctx = this.ctx;

        ctx.clearRect(0, 0, W, H);
        ctx.font = "10px Georgia";

        var f2t = function (x) {
            var dd = 1.0 * Math.pow(10, 2);
            return '' + Math.floor(x * dd) / dd;
        };

        // Draw guidelines and values
        ctx.strokeStyle = "#999";
        ctx.beginPath();
        var ng = 10;
        for (let gl = 0; gl &lt;= ng; gl++) {
            let xpos = gl / ng * (W - 2 * pad) + pad;
            ctx.moveTo(xpos, pad);
            ctx.lineTo(xpos, H - pad);
            ctx.fillText(f2t(gl / ng * this.stepHorizon / 1000) + 'k', xpos, H - pad + 14);
        }

        for (let v = 0; v &lt;= ng; v++) {
            let ypos = v / ng * (H - 2 * pad) + pad;
            ctx.moveTo(pad, ypos);
            ctx.lineTo(W - pad, ypos);
            ctx.fillText(f2t((ng - v) / ng * (this.maxy - this.miny) + this.miny), 0, ypos);
        }
        ctx.stroke();

        var agentN = [];
        for (let z = 0; z &lt; this.numLines; z++) {
            agentN[z] = this.pts[z].length;
            if (agentN[z] &lt; 2) {
                return;
            }
        }

        // Draw legend
        for (let l = 0; l &lt; this.numLines; l++) {
            ctx.fillStyle = this.legend[l].color;
            ctx.fillText(this.legend[l].name, W - pad - 100, pad + 20 + l * 16);
        }

        // Draw the actual curve
        var t = function (x, y, s) {
            let tx = x / s.stepHorizon * (W - pad * 2) + pad,
                ty = H - ((y - s.miny) / (s.maxy - s.miny) * (H - pad * 2) + pad);

            return {
                tx: tx,
                ty: ty
            };
        };

        for (let l = 0; l &lt; this.numLines; l++) {
            ctx.strokeStyle = this.legend[l].color;
            ctx.beginPath();
            for (let k = 0; k &lt; agentN[l]; k++) {
                // Draw line from i-1 to i
                let p = this.pts[l][k],
                    pt = t(p.step, p.yl[0], this);
                if (k === 0) {
                    ctx.moveTo(pt.tx, pt.ty);
                } else {
                    ctx.lineTo(pt.tx, pt.ty);
                }
            }
            ctx.stroke();
        }
        ctx.fillStyle = "black";
    };

    global.RewardGraph = RewardGraph;

}(this));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="-_anonymous_-WaterWorldGA-Trainer.html">Trainer</a></li><li><a href="Agent.html">Agent</a></li><li><a href="AgentGA.html">AgentGA</a></li><li><a href="AgentRLDQN.html">AgentRLDQN</a></li><li><a href="AgentRLTD.html">AgentRLTD</a></li><li><a href="AgentTD.html">AgentTD</a></li><li><a href="Bitmap.html">Bitmap</a></li><li><a href="Button.html">Button</a></li><li><a href="Camera.html">Camera</a></li><li><a href="Cell.html">Cell</a></li><li><a href="Chromosome.html">Chromosome</a></li><li><a href="CollisionDetector.html">CollisionDetector</a></li><li><a href="datGUI.html">datGUI</a></li><li><a href="DeterministPG.html">DeterministPG</a></li><li><a href="DPAgent.html">DPAgent</a></li><li><a href="DQNAgent.html">DQNAgent</a></li><li><a href="Entity.html">Entity</a></li><li><a href="EntityRLDQN.html">EntityRLDQN</a></li><li><a href="ESPNet.html">ESPNet</a></li><li><a href="ESPTrainer.html">ESPTrainer</a></li><li><a href="Experience.html">Experience</a></li><li><a href="Eye.html">Eye</a></li><li><a href="GATrainer.html">GATrainer</a></li><li><a href="Graph.html">Graph</a></li><li><a href="Grid.html">Grid</a></li><li><a href="GridWorld.html">GridWorld</a></li><li><a href="Interactions.html">Interactions</a></li><li><a href="Map.html">Map</a></li><li><a href="Mat.html">Mat</a></li><li><a href="Maze.html">Maze</a></li><li><a href="MazeWorld.html">MazeWorld</a></li><li><a href="Menu.html">Menu</a></li><li><a href="Player.html">Player</a></li><li><a href="PuckWorld.html">PuckWorld</a></li><li><a href="QuadTree.html">QuadTree</a></li><li><a href="RecurrentReinforceAgent.html">RecurrentReinforceAgent</a></li><li><a href="RewardGraph.html">RewardGraph</a></li><li><a href="SimpleReinforceAgent.html">SimpleReinforceAgent</a></li><li><a href="Solver.html">Solver</a></li><li><a href="TDAgent.html">TDAgent</a></li><li><a href="TDBrain.html">TDBrain</a></li><li><a href="UI.html">UI</a></li><li><a href="Vec.html">Vec</a></li><li><a href="Wall.html">Wall</a></li><li><a href="WaterWorld.html">WaterWorld</a></li><li><a href="WaterWorldEX.html">WaterWorldEX</a></li><li><a href="WaterWorldGA.html">WaterWorldGA</a></li><li><a href="Window.html">Window</a></li><li><a href="World.html">World</a></li></ul><h3>Global</h3><ul><li><a href="global.html#clear">clear</a></li><li><a href="global.html#clone">clone</a></li><li><a href="global.html#divide">divide</a></li><li><a href="global.html#findInsertNode">findInsertNode</a></li><li><a href="global.html#findOverlappingNodes">findOverlappingNodes</a></li><li><a href="global.html#insert">insert</a></li><li><a href="global.html#retrieve">retrieve</a></li><li><a href="global.html#Utility">Utility</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.3</a> on Thu Oct 22 2015 15:27:15 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
